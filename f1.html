<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Results - SecureBank</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script async src="https://securepubads.g.doubleclick.net/tag/js/gpt.js"></script>
    <script>
        (function () {
            // Initialize googletag if not already defined
            window.googletag = window.googletag || { cmd: [] };

            // Ad slot variables
            let adSlot1, adSlot2, anchorSlot;
            const refreshInterval = 30000; // 30 seconds - more user-friendly refresh rate
            let refreshTimer;

            // Function to set up ads
            function setupAds() {
                googletag.cmd.push(function () {
                    // Setup PubAds
                    const pubads = googletag.pubads();
                    pubads.enableSingleRequest();
                    pubads.setCentering(true);

                    // Apply geotargeting if available
                    if (window.geoTarget) {
                        pubads.setLocation(window.geoTarget);
                    }

                    // Define Ad Slots with consistent IDs
                    adSlot1 = googletag.defineSlot(
                        '/22792691312,23308311652/web_nurcodes.com_display_banner_0',
                        [[300, 250], [320, 480], [250, 250], [300, 100], 'fluid', [336, 280]],
                        'ad-slot-1'
                    ).addService(pubads);

                    adSlot2 = googletag.defineSlot(
                        '/22792691312,23308311652/web_nurcodes.com_display_banner_1',
                        [[300, 250], [320, 480], [250, 250], [300, 100], 'fluid', [336, 280]],
                        'ad-slot-2'
                    ).addService(pubads);

                    // Define anchor ad with proper ID
                    anchorSlot = googletag.defineOutOfPageSlot(
                        '/22792691312,23308311652/web_nurcodes.com_display_banner_2',
                        googletag.enums.OutOfPageFormat.BOTTOM_ANCHOR
                    );

                    if (anchorSlot) {
                        anchorSlot.addService(pubads);
                        // Use the correct ID for the anchor ad
                        anchorSlot.setElementId('ad-anchor-slot');
                    }

                    // Event listeners for ad loading
                    pubads.addEventListener('slotRenderEnded', function (event) {
                        // Handle ad render events if needed
                        const slotId = event.slot.getSlotElementId();
                        const isEmpty = event.isEmpty;

                        // Example: hide containers with no ads
                        if (isEmpty && document.getElementById(slotId)) {
                            document.getElementById(slotId).style.display = 'none';
                        }
                    });

                    // Enable services
                    googletag.enableServices();

                    // Display ads
                    try {
                        if (document.getElementById('ad-slot-1')) {
                            googletag.display('ad-slot-1');
                        }
                        if (document.getElementById('ad-slot-2')) {
                            googletag.display('ad-slot-2');
                        }
                        if (document.getElementById('ad-anchor-slot')) {
                            googletag.display('ad-anchor-slot');
                        }
                    } catch (error) {
                        console.log('Error displaying ads:', error);
                    }

                    // Set up periodic refresh with error handling
                    setupAdRefresh();
                });
            }

            // Function to handle ad refresh
            function setupAdRefresh() {
                if (refreshTimer) {
                    clearInterval(refreshTimer);
                }

                refreshTimer = setInterval(function () {
                    try {
                        // Only refresh if slots exist and are defined
                        const slotsToRefresh = [];
                        if (adSlot1) slotsToRefresh.push(adSlot1);
                        if (adSlot2) slotsToRefresh.push(adSlot2);

                        if (slotsToRefresh.length > 0) {
                            googletag.cmd.push(function () {
                                googletag.pubads().refresh(slotsToRefresh);
                            });
                        }
                    } catch (error) {
                        console.log('Error refreshing ads:', error);
                        clearInterval(refreshTimer); // Stop trying on persistent errors
                    }
                }, refreshInterval);
            }

            // Check for ad blockers (simple detection)
            function checkAdBlocker() {
                const testAd = document.createElement('div');
                testAd.innerHTML = '&nbsp;';
                testAd.className = 'adsbox';
                document.body.appendChild(testAd);

                setTimeout(function () {
                    if (testAd.offsetHeight === 0) {
                        console.log('Ad blocker detected');
                        // You can show a message to users or implement fallback content
                    }
                    document.body.removeChild(testAd);
                }, 100);
            }

            // Initialize ads when DOM is ready
            if (document.readyState === 'complete' || document.readyState === 'interactive') {
                setupAds();
                checkAdBlocker();
            } else {
                document.addEventListener('DOMContentLoaded', function () {
                    setupAds();
                    checkAdBlocker();
                });
            }

            // Clean up on page unload
            window.addEventListener('beforeunload', function () {
                if (refreshTimer) {
                    clearInterval(refreshTimer);
                }
            });
        })();

    </script>

    <style>
        #banner-ad {
            width: 100%;
            max-width: 425px;
            margin: 1rem auto 0.5rem;
            padding: 0.5rem;
            background: hsl(240, 6%, 97%);
            box-shadow: 0 4px 15px var(--shadow-dark);
            border-radius: 8px;
            position: relative;
            text-align: center;
            border: 1px solid var(--accent-gold);
        }

        #banner-ad::before {
            content: "Advertisement";
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.7rem;
            font-weight: 500;
            color: var(--accent-gold);
            background: var(--primary-dark);
            padding: 0 8px;
            border-radius: 4px;
            border: 1px solid var(--accent-gold);
        }

        .ad-divider {
            width: 90%;
            max-width: 425px;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--accent-gold), transparent);
            margin: 0.5rem auto;
        }
    </style>



    <style>
        :root {
            --primary-blue: #1a4f8c;
            --secondary-blue: #2c6cb0;
            --accent-gold: #d4af37;
            --dark-blue: #1e293b;
            --light-gray: #f8fafc;
            --success: #10b981;
            --danger: #ef4444;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f1f5f9;
            color: #334155;
            line-height: 1.6;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            padding: 25px 0;
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            margin-bottom: 20px;
        }

        .content-section {
            background: white;
            padding: 25px;
            border-radius: 16px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            margin-bottom: 20px;
        }

        .action-btn {
            display: inline-block;
            padding: 15px 25px;
            border-radius: 12px;
            text-decoration: none;
            font-weight: 600;
            font-size: 16px;
            margin: 10px 5px;
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s;
            border: none;
            cursor: pointer;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .btn-primary {
            background: var(--primary-blue);
            color: white;
        }

        .btn-secondary {
            background: var(--accent-gold);
            color: white;
        }

        .result-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .score-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: var(--light-gray);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            border: 6px solid var(--primary-blue);
            position: relative;
        }

        .score-text {
            font-size: 36px;
            font-weight: 700;
            color: var(--primary-blue);
        }

        .score-total {
            font-size: 18px;
            color: var(--dark-blue);
            position: absolute;
            bottom: -30px;
        }

        .result-message {
            font-size: 20px;
            text-align: center;
            margin-bottom: 30px;
            padding: 15px;
            border-radius: 12px;
        }

        .result-excellent {
            background: #d1fae5;
            color: #065f46;
        }

        .result-good {
            background: #dbeafe;
            color: #1e40af;
        }

        .result-average {
            background: #fef3c7;
            color: #92400e;
        }

        .result-poor {
            background: #fee2e2;
            color: #b91c1c;
        }

        .review-section {
            margin-top: 30px;
        }

        .review-item {
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            background: #f8fafc;
        }

        .review-item.correct {
            border-left: 4px solid var(--success);
        }

        .review-item.incorrect {
            border-left: 4px solid var(--danger);
        }

        .review-question {
            font-weight: 600;
            margin-bottom: 10px;
        }

        .review-answer {
            margin-bottom: 5px;
        }

        .review-correct {
            color: var(--success);
            font-weight: 600;
        }

        .review-incorrect {
            color: var(--danger);
            font-weight: 600;
        }

        .recommendations {
            background: #f0f9ff;
            padding: 20px;
            border-radius: 12px;
            margin-top: 30px;
        }

        .recommendations h3 {
            color: var(--primary-blue);
            margin-bottom: 15px;
        }

        .recommendations ul {
            padding-left: 20px;
        }

        .recommendations li {
            margin-bottom: 10px;
        }

        .text-center {
            text-align: center;
        }
    </style>
</head>

<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div style="display: flex; align-items: center; justify-content: center; margin-bottom: 10px;">
                <div
                    style="width: 50px; height: 50px; border-radius: 12px; background: var(--primary-blue); display: flex; align-items: center; justify-content: center; margin-right: 10px;">
                    <i class="fas fa-chart-line text-white" style="font-size: 24px;"></i>
                </div>
                <h1 style="font-size: 24px; font-weight: 700; color: var(--primary-blue);">Quiz Results</h1>
            </div>
            <p style="color: var(--dark-blue); font-size: 16px;">Your Financial Knowledge Assessment</p>
        </div>
        <!-- ads  -->
        <div id="banner-ad" class="ads-box" style="min-height: 250px;">
            <div id="ad-slot-1" class="ad-container" style="display: block !important;"></div>
        </div>
        <!-- Results Section -->
        <div class="content-section">
            <div class="result-header">
                <div class="score-circle">
                    <span class="score-text" id="score-value">0</span>
                    <span class="score-total" id="score-total">/5</span>
                </div>
                <h2>Your Financial Literacy Score</h2>
            </div>

            <div class="result-message" id="result-message">
                <!-- Message will be inserted by JavaScript -->
            </div>

            <div class="text-center">
                <button class="action-btn btn-primary" onclick="retakeQuiz()">
                    <i class="fas fa-redo"></i> Retake Quiz
                </button>
                <button class="action-btn btn-secondary" onclick="goBack()">
                    <i class="fas fa-arrow-left"></i> Back to Funds
                </button>
            </div>
            <!-- ads units  -->
            <div id="banner-ad" class="ads-box" style="min-height: 250px;">
                <div id="ad-slot-2" class="ad-container" style="display: block !important;"></div>
            </div>

            <!-- Review Section -->
            <div class="review-section">
                <h3>Question Review</h3>
                <div id="review-container">
                    <!-- Review items will be inserted by JavaScript -->
                </div>
            </div>

            <!-- Recommendations -->
            <div class="recommendations">
                <h3>Recommended Next Steps</h3>
                <ul id="recommendations-list">
                    <!-- Recommendations will be inserted by JavaScript -->
                </ul>
            </div>
        </div>
    </div>

    <script>
        // Get quiz results from localStorage
        const quizScore = parseInt(localStorage.getItem('quizScore')) || 0;
        const totalQuestions = parseInt(localStorage.getItem('totalQuestions')) || 5;
        const userAnswers = JSON.parse(localStorage.getItem('userAnswers') || '[]');
        const quizQuestions = JSON.parse(localStorage.getItem('quizQuestions') || '[]');

        // DOM elements
        const scoreValue = document.getElementById('score-value');
        const scoreTotal = document.getElementById('score-total');
        const resultMessage = document.getElementById('result-message');
        const reviewContainer = document.getElementById('review-container');
        const recommendationsList = document.getElementById('recommendations-list');

        // Display results when page loads
        document.addEventListener('DOMContentLoaded', function () {
            // Display score
            scoreValue.textContent = quizScore;
            scoreTotal.textContent = `/${totalQuestions}`;

            // Display message based on score
            let message = '';
            let messageClass = '';

            if (quizScore === totalQuestions) {
                message = 'Excellent! You have a strong understanding of financial concepts.';
                messageClass = 'result-excellent';
            } else if (quizScore >= totalQuestions * 0.7) {
                message = 'Great job! You have good financial knowledge.';
                messageClass = 'result-good';
            } else if (quizScore >= totalQuestions * 0.5) {
                message = 'Good effort! Consider learning more about personal finance.';
                messageClass = 'result-average';
            } else {
                message = 'Keep learning! Financial knowledge is key to success.';
                messageClass = 'result-poor';
            }

            resultMessage.textContent = message;
            resultMessage.className = `result-message ${messageClass}`;

            // Display question review
            displayQuestionReview();

            // Display recommendations
            displayRecommendations();
        });

        // Function to display question review
        function displayQuestionReview() {
            reviewContainer.innerHTML = '';

            quizQuestions.forEach((question, index) => {
                const isCorrect = userAnswers[index] === question.correctAnswer;

                const reviewItem = document.createElement('div');
                reviewItem.className = `review-item ${isCorrect ? 'correct' : 'incorrect'}`;

                reviewItem.innerHTML = `
                    <div class="review-question">${index + 1}. ${question.question}</div>
                    <div class="review-answer">Your answer: ${question.options[userAnswers[index]]}</div>
                    ${!isCorrect ? `<div class="review-answer review-correct">Correct answer: ${question.options[question.correctAnswer]}</div>` : ''}
                `;

                reviewContainer.appendChild(reviewItem);
            });
        }

        // Function to display recommendations
        function displayRecommendations() {
            const recommendations = [
                "Explore our Investment Education Center for articles and tutorials",
                "Consider speaking with one of our financial advisors for personalized guidance",
                "Check out our recommended reading list for financial literacy",
                "Try our interactive investment simulator to practice without risk",
                "Set up automatic investments to start building your portfolio"
            ];

            recommendationsList.innerHTML = '';

            recommendations.forEach(recommendation => {
                const listItem = document.createElement('li');
                listItem.textContent = recommendation;
                recommendationsList.appendChild(listItem);
            });
        }

        // Function to retake quiz
        function retakeQuiz() {
            window.location.href = 'fund.html';
        }

        // Function to go back to funds page
        function goBack() {
            window.location.href = 'fund.html';
        }
    </script>

    <!-- ads  -->
    <div id="ad-anchor-slot"></div>

    <script>
        // Disable right-click
        document.addEventListener('contextmenu', function (e) {
            e.preventDefault();
            alert('Right-click is disabled to protect our content.');
        });

        // Disable keyboard shortcuts
        document.onkeydown = function (e) {
            if (
                (e.ctrlKey && (e.key === 'u' || e.key === 's' || e.key === 'c' || e.key === 'i' || e.key === 'j')) ||
                e.key === 'F12' ||
                (e.metaKey && e.altKey && e.key === 'i')
            ) {
                e.preventDefault();
                alert('Access to developer tools and source code is disabled to protect our content.');
                return false;
            }
            return true;
        };

        // Disable text selection
        document.addEventListener('selectstart', function (e) {
            e.preventDefault();
        });

        // Disable drag and drop
        document.addEventListener('dragstart', function (e) {
            e.preventDefault();
        });
    </script>

    <script>
        window.googletag = window.googletag || { cmd: [] };
        var anchorSlot;
        googletag.cmd.push(function () {
            anchorSlot = googletag.defineOutOfPageSlot('/22792691312,23308311652/web_nurcodes.com_display_banner_2', googletag.enums.OutOfPageFormat.BOTTOM_ANCHOR);
            if (anchorSlot) {
                anchorSlot.addService(googletag.pubads());
            }
            googletag.pubads().enableSingleRequest();
            googletag.enableServices();
        });
    </script>

    <script>
        (function () {
            document.addEventListener("DOMContentLoaded", function () {
                console.log("DOM fully loaded.");

                function showRewardedAd() {
                    if (!window.googletag || !googletag.cmd) {
                        console.error("Google Ad Manager is not properly initialized.");
                        return;
                    }
                    // reward ads
                    googletag.cmd.push(function () {
                        try {
                            const rewardedSlot = googletag
                                .defineOutOfPageSlot('/22792691312,23308311652/web_nurcodes.com_display_banner_3', googletag.enums.OutOfPageFormat.REWARDED)
                                .addService(googletag.pubads());

                            googletag.enableServices();
                            googletag.display(rewardedSlot);
                            console.log("Attempting to display rewarded ad...");

                            googletag.pubads().addEventListener("rewardedSlotReady", function (evt) {
                                console.log("Rewarded ad ready.");
                                evt.makeRewardedVisible();
                            });

                            googletag.pubads().addEventListener("rewardedSlotClosed", function () {
                                console.log("Ad closed.");
                                googletag.destroySlots([rewardedSlot]);
                            });
                        } catch (error) {
                            console.error("Error during ad setup:", error);
                        }
                    });
                }

                // Add 2-second delay before showing the rewarded ad
                setTimeout(function () {
                    console.log("2 seconds elapsed, showing rewarded ad...");
                    showRewardedAd();
                }, 2000); // 2000 milliseconds = 2 seconds
            });
        })();
    </script>

</body>

</html>